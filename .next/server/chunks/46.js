"use strict";exports.id=46,exports.ids=[46],exports.modules={9303:(e,t,r)=>{e.exports=r(517)},2990:(e,t,r)=>{let n,i;r.d(t,{LP:()=>e9});var o,a,s,c,l,u,f=r(4770);let d=(e,t,r,n,i)=>{let o=parseInt(e.substr(3),10)>>3||20,a=(0,f.createHmac)(e,r.byteLength?r:new Uint8Array(o)).update(t).digest(),s=Math.ceil(i/o),c=new Uint8Array(o*s+n.byteLength+1),l=0,u=0;for(let t=1;t<=s;t++)c.set(n,u),c[u+n.byteLength]=t,c.set((0,f.createHmac)(e,a).update(c.subarray(l,u+n.byteLength+1)).digest(),u),l=u,u+=o;return c.slice(0,i)};"function"!=typeof f.hkdf||process.versions.electron||(n=async(...e)=>new Promise((t,r)=>{f.hkdf(...e,(e,n)=>{e?r(e):t(new Uint8Array(n))})}));let h=async(e,t,r,i,o)=>(n||d)(e,t,r,i,o);function p(e,t){if("string"==typeof e)return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function y(e,t,r,n,i){return h(function(e){switch(e){case"sha256":case"sha384":case"sha512":case"sha1":return e;default:throw TypeError('unsupported "digest" value')}}(e),function(e){let t=p(e,"ikm");if(!t.byteLength)throw TypeError('"ikm" must be at least one byte in length');return t}(t),p(r,"salt"),function(e){let t=p(e,"info");if(t.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return t}(n),function(e,t){if("number"!=typeof e||!Number.isInteger(e)||e<1)throw TypeError('"keylen" must be a positive integer');if(e>255*(parseInt(t.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return e}(i,e))}var m=r(8893);let w=(e,t)=>(0,f.createHash)(e).update(t).digest(),g=new TextEncoder,E=new TextDecoder;function v(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;return e.forEach(e=>{t.set(e,r),r+=e.length}),t}function A(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function b(e){let t=new Uint8Array(4);return A(t,e),t}function S(e){return v(b(e.length),e)}async function k(e,t,r){let n=Math.ceil((t>>3)/32),i=new Uint8Array(32*n);for(let t=0;t<n;t++){let n=new Uint8Array(4+e.length+r.length);n.set(b(t+1)),n.set(e,4),n.set(r,4+e.length),i.set(await w("sha256",n),32*t)}return i.slice(0,t>>3)}m.Buffer.isEncoding("base64url");let C=e=>m.Buffer.from(function(e){let t=e;return t instanceof Uint8Array&&(t=E.decode(t)),t}(e),"base64");class P extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}}class K extends P{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}}class T extends P{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}}class O extends P{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}class I extends P{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class W extends P{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}}class R extends P{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}}class B extends P{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}}class _ extends P{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}Symbol.asyncIterator;let H=(e,t)=>{if(t.length<<3!==function(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new I(`Unsupported JWE Algorithm: ${e}`)}}(e))throw new B("Invalid Initialization Vector length")};var J=r(1764);let x=J.types.isKeyObject?e=>J.types.isKeyObject(e):e=>null!=e&&e instanceof f.KeyObject,D=(e,t)=>{let r;switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new I(`Content Encryption Algorithm ${e} is not supported either by JOSE or your javascript runtime`)}if(t instanceof Uint8Array){let e=t.byteLength<<3;if(e!==r)throw new B(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}if(x(t)&&"secret"===t.type){let e=t.symmetricKeySize<<3;if(e!==r)throw new B(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}throw TypeError("Invalid Content Encryption Key type")},M=f.timingSafeEqual,U=f.webcrypto,$=J.types.isCryptoKey?e=>J.types.isCryptoKey(e):e=>!1;function j(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function L(e,t){return e.name===t}function G(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!L(e.algorithm,"AES-GCM"))throw j("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw j(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!L(e.algorithm,"AES-KW"))throw j("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw j(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw j("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!L(e.algorithm,"PBKDF2"))throw j("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!L(e.algorithm,"RSA-OAEP"))throw j("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(parseInt(e.algorithm.hash.name.slice(4),10)!==r)throw j(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}(function(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}})(e,r)}function F(e,t,...r){if(r.length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let N=(e,...t)=>F("Key must be ",e,...t);function z(e,t,...r){return F(`Key for the ${e} algorithm must be `,t,...r)}let V=e=>(i||(i=new Set((0,f.getCiphers)())),i.has(e)),X=e=>x(e)||$(e),q=["KeyObject"];(globalThis.CryptoKey||(null==U?void 0:U.CryptoKey))&&q.push("CryptoKey");let Y=(e,t,r,n,i,o)=>{let a;if($(t))G(t,e,"decrypt"),a=f.KeyObject.from(t);else if(t instanceof Uint8Array||x(t))a=t;else throw TypeError(N(t,...q,"Uint8Array"));switch(D(e,a),H(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,n,i,o){let a,s;let c=parseInt(e.slice(1,4),10);x(t)&&(t=t.export());let l=t.subarray(c>>3),u=t.subarray(0,c>>3),d=parseInt(e.slice(-3),10),h=`aes-${c}-cbc`;if(!V(h))throw new I(`alg ${e} is not supported by your javascript runtime`);let p=function(e,t,r,n,i,o){let a=v(e,t,r,function(e){let t=new Uint8Array(8);return A(t,Math.floor(e/4294967296),0),A(t,e%4294967296,4),t}(e.length<<3)),s=(0,f.createHmac)(`sha${n}`,i);return s.update(a),s.digest().slice(0,o>>3)}(o,n,r,d,u,c);try{a=M(i,p)}catch{}if(!a)throw new W;try{let e=(0,f.createDecipheriv)(h,l,n);s=v(e.update(r),e.final())}catch{}if(!s)throw new W;return s}(e,a,r,n,i,o);case"A128GCM":case"A192GCM":case"A256GCM":return function(e,t,r,n,i,o){let a=parseInt(e.slice(1,4),10),s=`aes-${a}-gcm`;if(!V(s))throw new I(`alg ${e} is not supported by your javascript runtime`);try{let e=(0,f.createDecipheriv)(s,t,n,{authTagLength:16});e.setAuthTag(i),o.byteLength&&e.setAAD(o,{plaintextLength:r.length});let a=e.update(r);return e.final(),a}catch{throw new W}}(e,a,r,n,i,o);default:throw new I("Unsupported JWE Content Encryption Algorithm")}};var Q=r(1568);let Z=(0,J.promisify)(Q.inflateRaw);(0,J.promisify)(Q.deflateRaw);let ee=e=>Z(e,{maxOutputLength:25e4}).catch(()=>{throw new R}),et=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0};function er(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}let en=(e,t,r)=>{let n=parseInt(e.slice(1,4),10),i=`aes${n}-wrap`;if(!V(i))throw new I(`alg ${e} is not supported either by JOSE or your javascript runtime`);let o=function(e,t,r){if(x(e))return e;if(e instanceof Uint8Array)return(0,f.createSecretKey)(e);if($(e))return G(e,t,r),f.KeyObject.from(e);throw TypeError(N(e,...q,"Uint8Array"))}(t,e,"unwrapKey");!function(e,t){if(e.symmetricKeySize<<3!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}(o,e);let a=(0,f.createDecipheriv)(i,o,m.Buffer.alloc(8,166));return v(a.update(r),a.final())},ei=m.Buffer.from([42,134,72,206,61,3,1,7]),eo=m.Buffer.from([43,129,4,0,34]),ea=m.Buffer.from([43,129,4,0,35]),es=m.Buffer.from([43,129,4,0,10]),ec=new WeakMap,el=e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new I("Unsupported key curve for this operation")}},eu=(e,t)=>{var r;let n;if($(e))n=f.KeyObject.from(e);else if(x(e))n=e;else throw TypeError(N(e,...q));if("secret"===n.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(n.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${n.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${n.asymmetricKeyType.slice(1)}`;case"ec":{if(ec.has(n))return ec.get(n);let e=null===(r=n.asymmetricKeyDetails)||void 0===r?void 0:r.namedCurve;if(e||"private"!==n.type){if(!e){let t=n.export({format:"der",type:"spki"}),r=t[1]<128?14:15,i=t[r],o=t.slice(r+1,r+1+i);if(o.equals(ei))e="prime256v1";else if(o.equals(eo))e="secp384r1";else if(o.equals(ea))e="secp521r1";else if(o.equals(es))e="secp256k1";else throw new I("Unsupported key curve for this operation")}}else e=eu((0,f.createPublicKey)(n),!0);if(t)return e;let i=el(e);return ec.set(n,i),i}default:throw TypeError("Invalid asymmetric key type for this operation")}};async function ef(e,t,r,n,i=new Uint8Array(0),o=new Uint8Array(0)){let a,s;if($(e))G(e,"ECDH"),a=f.KeyObject.from(e);else if(x(e))a=e;else throw TypeError(N(e,...q));if($(t))G(t,"ECDH","deriveBits"),s=f.KeyObject.from(t);else if(x(t))s=t;else throw TypeError(N(t,...q));let c=v(S(g.encode(r)),S(i),S(o),b(n));return k((0,f.diffieHellman)({privateKey:s,publicKey:a}),n,c)}(0,J.promisify)(f.generateKeyPair);let ed=e=>["P-256","P-384","P-521","X25519","X448"].includes(eu(e)),eh=(0,J.promisify)(f.pbkdf2),ep=async(e,t,r,n,i)=>{!function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new B("PBES2 Salt Input must be 8 or more octets")}(i);let o=v(g.encode(e),new Uint8Array([0]),i),a=parseInt(e.slice(13,16),10)>>3,s=function(e,t){if(x(e))return e.export();if(e instanceof Uint8Array)return e;if($(e))return G(e,t,"deriveBits","deriveKey"),f.KeyObject.from(e).export();throw TypeError(N(e,...q,"Uint8Array"))}(t,e),c=await eh(s,o,n,a,`sha${e.slice(8,11)}`);return en(e.slice(-6),c,r)},ey=new WeakMap,em=(e,t)=>{let r=e.readUInt8(1);if((128&r)==0)return 0===t?r:em(e.subarray(2+r),t-1);let n=127&r;r=0;for(let t=0;t<n;t++)r<<=8,r|=e.readUInt8(2+t);return 0===t?r:em(e.subarray(2+r),t-1)},ew=(e,t)=>{let r=e.readUInt8(1);return(128&r)==0?em(e.subarray(2),t):em(e.subarray(2+(127&r)),t)},eg=e=>{var t,r;if(ey.has(e))return ey.get(e);let n=null!==(r=null===(t=e.asymmetricKeyDetails)||void 0===t?void 0:t.modulusLength)&&void 0!==r?r:ew(e.export({format:"der",type:"pkcs1"}),"private"===e.type?1:0)-1<<3;return ey.set(e,n),n},eE=(e,t)=>{ey.set(e,t)},ev=(e,t)=>{if(2048>eg(e))throw TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)},eA=(e,t)=>{if("rsa"!==e.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");ev(e,t)},eb=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return f.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return f.constants.RSA_PKCS1_PADDING;default:return}},eS=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}},ek=(e,t,r)=>{let n=eb(e),i=eS(e),o=function(e,t,...r){if(x(e))return e;if($(e))return G(e,t,...r),f.KeyObject.from(e);throw TypeError(N(e,...q))}(t,e,"unwrapKey","decrypt");return eA(o,e),(0,f.privateDecrypt)({key:o,oaepHash:i,padding:n},r)};function eC(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new I(`Unsupported JWE Algorithm: ${e}`)}}let eP=e=>(0,f.randomFillSync)(new Uint8Array(eC(e)>>3)),eK=m.Buffer.from([0]),eT=m.Buffer.from([2]),eO=m.Buffer.from([3]),eI=m.Buffer.from([48]),eW=m.Buffer.from([4]),eR=e=>{if(e<128)return m.Buffer.from([e]);let t=m.Buffer.alloc(5);t.writeUInt32BE(e,1);let r=1;for(;0===t[r];)r++;return t[r-1]=128|5-r,t.slice(r-1)},eB=new Map([["P-256",m.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",m.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",m.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",m.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",m.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",m.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",m.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",m.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",m.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);class e_{constructor(){this.length=0,this.elements=[]}oidFor(e){let t=eB.get(e);if(!t)throw new I("Invalid or unsupported OID");this.elements.push(t),this.length+=t.length}zero(){this.elements.push(eT,m.Buffer.from([1]),eK),this.length+=3}one(){this.elements.push(eT,m.Buffer.from([1]),m.Buffer.from([1])),this.length+=3}unsignedInteger(e){if(128&e[0]){let t=eR(e.length+1);this.elements.push(eT,t,eK,e),this.length+=2+t.length+e.length}else{let t=0;for(;0===e[t]&&(128&e[t+1])==0;)t++;let r=eR(e.length-t);this.elements.push(eT,eR(e.length-t),e.slice(t)),this.length+=1+r.length+e.length-t}}octStr(e){let t=eR(e.length);this.elements.push(eW,eR(e.length),e),this.length+=1+t.length+e.length}bitStr(e){let t=eR(e.length+1);this.elements.push(eO,eR(e.length+1),eK,e),this.length+=1+t.length+e.length+1}add(e){this.elements.push(e),this.length+=e.length}end(e=eI){let t=eR(this.length);return m.Buffer.concat([e,t,...this.elements],1+t.length+this.length)}}let[eH,eJ]=process.versions.node.split(".").map(e=>parseInt(e,10));process.versions;let ex=eH>=16||15===eH&&eJ>=12,eD=e=>{if(ex&&"oct"!==e.kty)return e.d?(0,f.createPrivateKey)({format:"jwk",key:e}):(0,f.createPublicKey)({format:"jwk",key:e});switch(e.kty){case"oct":return(0,f.createSecretKey)(C(e.k));case"RSA":{let t=new e_,r=void 0!==e.d,n=m.Buffer.from(e.n,"base64"),i=m.Buffer.from(e.e,"base64");r?(t.zero(),t.unsignedInteger(n),t.unsignedInteger(i),t.unsignedInteger(m.Buffer.from(e.d,"base64")),t.unsignedInteger(m.Buffer.from(e.p,"base64")),t.unsignedInteger(m.Buffer.from(e.q,"base64")),t.unsignedInteger(m.Buffer.from(e.dp,"base64")),t.unsignedInteger(m.Buffer.from(e.dq,"base64")),t.unsignedInteger(m.Buffer.from(e.qi,"base64"))):(t.unsignedInteger(n),t.unsignedInteger(i));let o={key:t.end(),format:"der",type:"pkcs1"},a=r?(0,f.createPrivateKey)(o):(0,f.createPublicKey)(o);return eE(a,n.length<<3),a}case"EC":{var t,r;let n=new e_,i=void 0!==e.d,o=m.Buffer.concat([m.Buffer.alloc(1,4),m.Buffer.from(e.x,"base64"),m.Buffer.from(e.y,"base64")]);if(i){n.zero();let r=new e_;r.oidFor("ecPublicKey"),r.oidFor(e.crv),n.add(r.end());let i=new e_;i.one(),i.octStr(m.Buffer.from(e.d,"base64"));let a=new e_;a.bitStr(o);let s=a.end(m.Buffer.from([161]));i.add(s);let c=i.end(),l=new e_;l.add(c);let u=l.end(m.Buffer.from([4]));n.add(u);let d=n.end(),h=(0,f.createPrivateKey)({key:d,format:"der",type:"pkcs8"});return t=e.crv,ec.set(h,t),h}let a=new e_;a.oidFor("ecPublicKey"),a.oidFor(e.crv),n.add(a.end()),n.bitStr(o);let s=n.end(),c=(0,f.createPublicKey)({key:s,format:"der",type:"spki"});return r=e.crv,ec.set(c,r),c}case"OKP":{let t=new e_;if(void 0!==e.d){t.zero();let r=new e_;r.oidFor(e.crv),t.add(r.end());let n=new e_;n.octStr(m.Buffer.from(e.d,"base64"));let i=n.end(m.Buffer.from([4]));t.add(i);let o=t.end();return(0,f.createPrivateKey)({key:o,format:"der",type:"pkcs8"})}let r=new e_;r.oidFor(e.crv),t.add(r.end()),t.bitStr(m.Buffer.from(e.x,"base64"));let n=t.end();return(0,f.createPublicKey)({key:n,format:"der",type:"spki"})}default:throw new I('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}};async function eM(e,t,r){var n;if(!er(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return eD({...e,alg:t,ext:null!==(n=e.ext)&&void 0!==n&&n});return C(e.k);case"RSA":if(void 0!==e.oth)throw new I('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return eD({...e,alg:t});default:throw new I('Unsupported "kty" (Key Type) Parameter value')}}let eU=(e,t)=>{if(!(t instanceof Uint8Array)){if(!X(t))throw TypeError(z(e,t,...q,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${q.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},e$=(e,t,r)=>{if(!X(t))throw TypeError(z(e,t,...q));if("secret"===t.type)throw TypeError(`${q.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${q.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${q.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${q.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${q.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},ej=(e,t,r)=>{e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?eU(e,t):e$(e,t,r)};async function eL(e,t,r,n,i){return Y(e.slice(0,7),t,r,n,i,new Uint8Array(0))}async function eG(e,t,r,n,i){switch(ej(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new B("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new B("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i,o;if(!er(n.epk))throw new B('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!ed(t))throw new I("ECDH with the provided key is not allowed or not supported by your javascript runtime");let a=await eM(n.epk,e);if(void 0!==n.apu){if("string"!=typeof n.apu)throw new B('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{i=C(n.apu)}catch{throw new B("Failed to base64url decode the apu")}}if(void 0!==n.apv){if("string"!=typeof n.apv)throw new B('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{o=C(n.apv)}catch{throw new B("Failed to base64url decode the apv")}}let s=await ef(a,t,"ECDH-ES"===e?n.enc:e,"ECDH-ES"===e?eC(n.enc):parseInt(e.slice(-5,-2),10),i,o);if("ECDH-ES"===e)return s;if(void 0===r)throw new B("JWE Encrypted Key missing");return en(e.slice(-6),s,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new B("JWE Encrypted Key missing");return ek(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let o;if(void 0===r)throw new B("JWE Encrypted Key missing");if("number"!=typeof n.p2c)throw new B('JOSE Header "p2c" (PBES2 Count) missing or invalid');let a=(null==i?void 0:i.maxPBES2Count)||1e4;if(n.p2c>a)throw new B('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof n.p2s)throw new B('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{o=C(n.p2s)}catch{throw new B("Failed to base64url decode the p2s")}return ep(e,t,r,n.p2c,o)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new B("JWE Encrypted Key missing");return en(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let i,o;if(void 0===r)throw new B("JWE Encrypted Key missing");if("string"!=typeof n.iv)throw new B('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof n.tag)throw new B('JOSE Header "tag" (Authentication Tag) missing or invalid');try{i=C(n.iv)}catch{throw new B("Failed to base64url decode the iv")}try{o=C(n.tag)}catch{throw new B("Failed to base64url decode the tag")}return eL(e,t,r,i,o)}default:throw new I('Invalid or unsupported "alg" (JWE Algorithm) header value')}}let eF=function(e,t,r,n,i){let o;if(void 0!==i.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let a of(o=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,n.crit)){if(!o.has(a))throw new I(`Extension Header Parameter "${a}" is not recognized`);if(void 0===i[a])throw new e(`Extension Header Parameter "${a}" is missing`);if(o.get(a)&&void 0===n[a])throw new e(`Extension Header Parameter "${a}" MUST be integrity protected`)}return new Set(n.crit)},eN=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function ez(e,t,r){var n;let i,o,a,s,c,l,u;if(!er(e))throw new B("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new B("JOSE Header missing");if("string"!=typeof e.iv)throw new B("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new B("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new B("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new B("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new B("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new B("JWE AAD incorrect type");if(void 0!==e.header&&!er(e.header))throw new B("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!er(e.unprotected))throw new B("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=C(e.protected);i=JSON.parse(E.decode(t))}catch{throw new B("JWE Protected Header is invalid")}if(!et(i,e.header,e.unprotected))throw new B("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let f={...i,...e.header,...e.unprotected};if(eF(B,new Map,null==r?void 0:r.crit,i,f),void 0!==f.zip){if(!i||!i.zip)throw new B('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==f.zip)throw new I('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:d,enc:h}=f;if("string"!=typeof d||!d)throw new B("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof h||!h)throw new B("missing JWE Encryption Algorithm (enc) in JWE Header");let p=r&&eN("keyManagementAlgorithms",r.keyManagementAlgorithms),y=r&&eN("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(p&&!p.has(d))throw new O('"alg" (Algorithm) Header Parameter not allowed');if(y&&!y.has(h))throw new O('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==e.encrypted_key)try{o=C(e.encrypted_key)}catch{throw new B("Failed to base64url decode the encrypted_key")}let m=!1;"function"==typeof t&&(t=await t(i,e),m=!0);try{a=await eG(d,t,o,f,r)}catch(e){if(e instanceof TypeError||e instanceof B||e instanceof I)throw e;a=eP(h)}try{s=C(e.iv)}catch{throw new B("Failed to base64url decode the iv")}try{c=C(e.tag)}catch{throw new B("Failed to base64url decode the tag")}let w=g.encode(null!==(n=e.protected)&&void 0!==n?n:"");l=void 0!==e.aad?v(w,g.encode("."),g.encode(e.aad)):w;try{u=C(e.ciphertext)}catch{throw new B("Failed to base64url decode the ciphertext")}let A=await Y(h,a,u,s,c,l);"DEF"===f.zip&&(A=await ((null==r?void 0:r.inflateRaw)||ee)(A));let b={plaintext:A};if(void 0!==e.protected&&(b.protectedHeader=i),void 0!==e.aad)try{b.additionalAuthenticatedData=C(e.aad)}catch{throw new B("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(b.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(b.unprotectedHeader=e.header),m)?{...b,key:t}:b}async function eV(e,t,r){if(e instanceof Uint8Array&&(e=E.decode(e)),"string"!=typeof e)throw new B("Compact JWE must be a string or Uint8Array");let{0:n,1:i,2:o,3:a,4:s,length:c}=e.split(".");if(5!==c)throw new B("Invalid Compact JWE");let l=await ez({ciphertext:a,iv:o||void 0,protected:n||void 0,tag:s||void 0,encrypted_key:i||void 0},t,r),u={plaintext:l.plaintext,protectedHeader:l.protectedHeader};return"function"==typeof t?{...u,key:l.key}:u}let eX=e=>Math.floor(e.getTime()/1e3),eq=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,eY=e=>{let t=eq.exec(e);if(!t)throw TypeError("Invalid time period format");let r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(86400*r);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(31557600*r)}},eQ=e=>e.toLowerCase().replace(/^application\//,""),eZ=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e))),e0=(e,t,r={})=>{let n,i;let{typ:o}=r;if(o&&("string"!=typeof e.typ||eQ(e.typ)!==eQ(o)))throw new K('unexpected "typ" JWT header value',"typ","check_failed");try{n=JSON.parse(E.decode(t))}catch{}if(!er(n))throw new _("JWT Claims Set must be a top-level JSON object");let{requiredClaims:a=[],issuer:s,subject:c,audience:l,maxTokenAge:u}=r;for(let e of(void 0!==u&&a.push("iat"),void 0!==l&&a.push("aud"),void 0!==c&&a.push("sub"),void 0!==s&&a.push("iss"),new Set(a.reverse())))if(!(e in n))throw new K(`missing required "${e}" claim`,e,"missing");if(s&&!(Array.isArray(s)?s:[s]).includes(n.iss))throw new K('unexpected "iss" claim value',"iss","check_failed");if(c&&n.sub!==c)throw new K('unexpected "sub" claim value',"sub","check_failed");if(l&&!eZ(n.aud,"string"==typeof l?[l]:l))throw new K('unexpected "aud" claim value',"aud","check_failed");switch(typeof r.clockTolerance){case"string":i=eY(r.clockTolerance);break;case"number":i=r.clockTolerance;break;case"undefined":i=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:f}=r,d=eX(f||new Date);if((void 0!==n.iat||u)&&"number"!=typeof n.iat)throw new K('"iat" claim must be a number',"iat","invalid");if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new K('"nbf" claim must be a number',"nbf","invalid");if(n.nbf>d+i)throw new K('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new K('"exp" claim must be a number',"exp","invalid");if(n.exp<=d-i)throw new T('"exp" claim timestamp check failed',"exp","check_failed")}if(u){let e=d-n.iat;if(e-i>("number"==typeof u?u:eY(u)))throw new T('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-i)throw new K('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return n};async function e1(e,t,r){let n=await eV(e,t,r),i=e0(n.protectedHeader,n.plaintext,r),{protectedHeader:o}=n;if(void 0!==o.iss&&o.iss!==i.iss)throw new K('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==o.sub&&o.sub!==i.sub)throw new K('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==o.aud&&JSON.stringify(o.aud)!==JSON.stringify(i.aud))throw new K('replicated "aud" claim header parameter mismatch',"aud","mismatch");let a={payload:i,protectedHeader:o};return"function"==typeof t?{...a,key:n.key}:a}var e2=function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},e6=function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class e4{constructor(e,t,r){o.add(this),a.set(this,{}),s.set(this,void 0),c.set(this,void 0),e2(this,c,r,"f"),e2(this,s,e,"f");let{cookies:n}=t,{name:i}=e;if("function"==typeof n?.getAll)for(let{name:e,value:t}of n.getAll())e.startsWith(i)&&(e6(this,a,"f")[e]=t);else if(n instanceof Map)for(let e of n.keys())e.startsWith(i)&&(e6(this,a,"f")[e]=n.get(e));else for(let e in n)e.startsWith(i)&&(e6(this,a,"f")[e]=n[e])}get value(){return Object.keys(e6(this,a,"f")).sort((e,t)=>parseInt(e.split(".").pop()||"0")-parseInt(t.split(".").pop()||"0")).map(e=>e6(this,a,"f")[e]).join("")}chunk(e,t){let r=e6(this,o,"m",u).call(this);for(let n of e6(this,o,"m",l).call(this,{name:e6(this,s,"f").name,value:e,options:{...e6(this,s,"f").options,...t}}))r[n.name]=n;return Object.values(r)}clean(){return Object.values(e6(this,o,"m",u).call(this))}}a=new WeakMap,s=new WeakMap,c=new WeakMap,o=new WeakSet,l=function(e){let t=Math.ceil(e.value.length/3933);if(1===t)return e6(this,a,"f")[e.name]=e.value,[e];let r=[];for(let n=0;n<t;n++){let t=`${e.name}.${n}`,i=e.value.substr(3933*n,3933);r.push({...e,name:t,value:i}),e6(this,a,"f")[t]=i}return e6(this,c,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:163,valueSize:e.value.length,chunks:r.map(e=>e.value.length+163)}),r},u=function(){let e={};for(let t in e6(this,a,"f"))delete e6(this,a,"f")?.[t],e[t]={name:t,value:"",options:{...e6(this,s,"f").options,maxAge:0}};return e};class e8 extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),Error.captureStackTrace?.(this,this.constructor),this.name=e instanceof e8?e.name:this.constructor.name}}class e5 extends e8{}async function e3(e){let{token:t,secret:r}=e;if(!t)return null;let n=await e7(r),{payload:i}=await e1(t,n,{clockTolerance:15});return i}async function e9(e){let{req:t,secureCookie:r=process.env.NEXTAUTH_URL?.startsWith("https://")??!!process.env.VERCEL,cookieName:n=r?"__Secure-next-auth.session-token":"next-auth.session-token",raw:i,decode:o=e3,logger:a=console,secret:s=process.env.AUTH_SECRET}=e;if(!t)throw Error("Must pass `req` to JWT getToken()");if(!s)throw new e5("Must pass `secret` if not set to JWT getToken()");let c=new e4({name:n,options:{secure:r}},{cookies:t.cookies,headers:t.headers},a).value,l=t.headers instanceof Headers?t.headers.get("authorization"):t.headers.authorization;if(c||l?.split(" ")[0]!=="Bearer"||(c=decodeURIComponent(l.split(" ")[1])),!c)return null;if(i)return c;try{return await o({token:c,secret:s})}catch{return null}}async function e7(e){return await y("sha256",e,"","Auth.js Generated Encryption Key",32)}}};